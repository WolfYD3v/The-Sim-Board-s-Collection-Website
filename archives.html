<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Sim Board's Collection - WEBSITE [ARCHIVES]</title>
</head>
<body>
    <div id="file-explorer">
        <p>Chargement de l'arborescence des fichiers...</p>
    </div>

    <script>
        // Le nom du fichier JSON g√©n√©r√© par votre script Python/Node.js
        const OUTPUT_FILE = 'structure.json'; 
        
        // L'URL de base de votre site GitHub Pages
        const BASE_URL = 'https://wolfyd3v.github.io/The-Sim-Board-s-Collection-Website/';

        /* --- Fonctions JavaScript pour g√©n√©rer l'explorateur --- */

        // Fonction r√©cursive pour g√©n√©rer l'HTML √† partir de la structure
        function generateExplorerHTML(items) {
            let html = '<ul class="file-list">';
            items.forEach(item => {
                const isFolder = item.type === 'folder';
                const icon = isFolder ? 'üìÇ' : 'üìÑ';

                if (isFolder) {
                    // Pour les dossiers
                    html += `<li class="folder closed" data-name="${item.name}">`;
                    html += `<span class="folder-name">`;
                    html += `<span class="folder-toggle">‚ñ∫</span>`; // Bouton √† bascule
                    html += `<span class="icon">${icon}</span> ${item.name}`;
                    html += `</span>`;
                    html += `<div class="folder-content">`;
                    // Appel r√©cursif pour les sous-dossiers/fichiers
                    html += generateExplorerHTML(item.children); 
                    html += `</div>`;
                    html += `</li>`;
                } else {
                    // Pour les fichiers
                    const fileUrl = BASE_URL + item.path; 

                    html += `<li>`;
                    html += `<a href="${fileUrl}" target="_blank" class="file-name">`;
                    html += `<span class="icon">${icon}</span> ${item.name}`;
                    html += `</a>`;
                    html += `</li>`;
                }
            });
            html += '</ul>';
            return html;
        }

        // Fonction pour g√©rer le clic et ouvrir/fermer les dossiers
        function setupToggle() {
            const folders = document.querySelectorAll('.folder');
            folders.forEach(folder => {
                const toggle = folder.querySelector('.folder-toggle');
                const nameSpan = folder.querySelector('.folder-name');

                // On attache l'√©v√©nement au nom du dossier pour que ce soit plus facile de cliquer
                nameSpan.addEventListener('click', (e) => {
                    if (e.target !== toggle && e.target !== nameSpan) return; 
                    
                    folder.classList.toggle('closed');
                    toggle.textContent = folder.classList.contains('closed') ? '‚ñ∫' : '‚ñº';
                });
            });
        }

        // Point de d√©part de l'ex√©cution : Chargement du fichier JSON
        document.addEventListener('DOMContentLoaded', () => {
            const explorerContainer = document.getElementById('file-explorer');
            
            // --- NOUVEAU : Chargement du fichier JSON depuis le serveur ---
            fetch(OUTPUT_FILE)
                .then(response => {
                    // V√©rifie si la requ√™te a r√©ussi (statut HTTP 200)
                    if (!response.ok) {
                        throw new Error(`Erreur HTTP : Le fichier '${OUTPUT_FILE}' est introuvable ou n'est pas accessible. (Statut: ${response.status})`);
                    }
                    return response.json();
                })
                .then(fileStructure => {
                    // 1. G√©n√©rer l'HTML une fois que les donn√©es sont charg√©es
                    explorerContainer.innerHTML = generateExplorerHTML(fileStructure);

                    // 2. Attacher les √©v√©nements (clics)
                    setupToggle();
                })
                .catch(error => {
                    // Afficher l'erreur si le fichier JSON n'est pas lu
                    explorerContainer.innerHTML = `<p>Error : ${error.message}</p>`;
                });
        });

    </script>
</body>
</html>
